<div class="container">



  <div class="row">

    <h1><%= @episode.name %></h1>



    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#loginModal" >Ajouter RDV</button>



        <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Ajouter un RDV</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <%= render "appointments/form_appointment" %>
              </div>

            </div>
          </div>
        </div>


<!-- modal note-->

      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#loginModal2" >Ajouter une Note</button>


        <div class="modal fade" id="loginModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Ajouter une Note</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <%= render "notes/form_note" %>
              </div>

            </div>
          </div>
        </div>





    <div class="card-event-timeline-begin">


    </div>

    <% @events.each do |event| %>

      <div class="col-xs-12">

        <!-- card begin -->


        <div class="card-event-timeline" >

          <div class="card-event-timeline-left">
            <div class="card-event-timeline-date">
              <p><%=event.date.strftime('%d/%m/%Y')%></p>
            </div>
          </div>

          <div class="card-event-timeline-middle">

            <div class="card-event-timeline-name">
              <% if event.category == "appointment" %>
                <p>Rendez-vous avec <%=event.caregiver.firstname.capitalize%> <%=event.caregiver.lastname.capitalize%>, <%=event.caregiver.speciality.capitalize%> </p>
              <% else %>
                <p>Prise de note</p>
              <% end %>
            </div>

            <div class="card-event-timeline-description">
              <p>
                <i class="fa fa-angle-double-left" aria-hidden="true"></i>
                <%= event.description%>
                <i class="fa fa-angle-double-right" aria-hidden="true"></i>
              </p>
            </div>

            <% if event.documents.size > 0 %>
              <div class="card-event-timeline-documents">
                  <i class="fa fa-paperclip" aria-hidden="true"></i>

                  <span aria-hidden="true" data-toggle="collapse" data-target="#<%= event.id%>"> <%= pluralize event.documents.size, "document", "documents" %> </span>

                  <div id="<%= event.id %>" class="collapse out">

                    <ul>
                      <% event.documents.each do |document|  %>
                        <li data-toggle="modal" data-target="#<%= document.id%>">
                          <%= document.name %>
                        </li>
                        <div class="modal fade" id="<%= document.id%>" tabindex="-1" role="dialog"  aria-labelledby="myModalLabel">
                          <div class="modal-dialog" role="document">
                            <div class="modal-content">
                              <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label=  "Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="myModalLabel"><%= document.name.capitalize %> enregistr√© le <%= document.created_at.strftime('%d/%m/%Y') %></h4>
                              </div>
                              <div class="modal-body">
                                <%= cl_image_tag document.document, :height=> 200 %>


                              </div>
                              <div class="modal-footer">
                                <button type="button" class="btn-blue" data-dismiss="modal">Close</ button>
<!--                                 <button type="button" class="btn-blue">Save changes</button>
 -->                              </div>
                            </div>
                          </div>
                        </div>
                      <% end %>
                    </ul>
                  </div>
              </div>
            <% end %>

          </div>

          <div class="card-event-timeline-right">
            <div class="card-event-timeline-picto">
              <% if event.category == "consultation" %>
                <%= cl_image_tag event.caregiver.photo, :height=> 60, :radius=>50 %>
              <% else %>
                <%= cl_image_tag @episode.patient.photo, :height=> 60, :radius=>50 %>
              <% end %>


            </div>
            <div class="card-event-timeline-btn">
              <%= link_to episodes_path, class:"btn btn-primary" do %>
                <i class="fa fa-file-text" aria-hidden="true"></i>
              <% end %>
            </div>
          </div>

        </div>
        <!-- card end -->
      </div>

    <% end %>
  </div>
</div>





